<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - QuickCred | Manage Your Loans</title>
    <meta name="description" content="Manage your loans, track applications, and access financial tools in your personalized QuickCred dashboard.">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../css/modern-style.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="icon" href="../assets/QuickCred_logo1.png" type="image/png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="dashboard-body">
    <!-- Dashboard Header -->
    <header class="dashboard-header">
        <div class="container">
            <div class="header-container">
                <!-- Brand -->
                <div class="header-brand">
                    <a href="../index.html" class="brand-link">
                        <img src="../assets/QuickCred_logo1.png" alt="QuickCred">
                        <span>QuickCred</span>
                    </a>
                </div>
                
                <!-- Search -->
                <div class="header-search">
                    <div class="search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search loans, payments, documents...">
                    </div>
                </div>
                
                <!-- Header Actions -->
                <div class="header-actions">
                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <button class="action-btn" title="Loan Calculator" onclick="openCalculator()">
                            <i class="fas fa-calculator"></i>
                        </button>
                        <button class="action-btn" title="Apply for New Loan" onclick="openNewApplication()">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    
                    <!-- Notifications -->
                    <div class="notifications">
                        <button class="notification-btn" id="notificationBtn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-count">3</span>
                        </button>
                        <div class="notification-dropdown" id="notificationDropdown">
                            <div class="notification-header">
                                <h4>Notifications</h4>
                                <button class="mark-all-read">Mark all as read</button>
                            </div>
                            <div class="notification-list">
                                <div class="notification-item unread">
                                    <i class="fas fa-check-circle text-success"></i>
                                    <div class="notification-content">
                                        <p>Your personal loan application has been approved!</p>
                                        <span class="notification-time">2 hours ago</span>
                                    </div>
                                </div>
                                <div class="notification-item unread">
                                    <i class="fas fa-clock text-warning"></i>
                                    <div class="notification-content">
                                        <p>Payment due in 3 days for Auto Loan #AL-2024-001</p>
                                        <span class="notification-time">1 day ago</span>
                                    </div>
                                </div>
                                <div class="notification-item">
                                    <i class="fas fa-info-circle text-primary"></i>
                                    <div class="notification-content">
                                        <p>New loan offers available based on your credit score</p>
                                        <span class="notification-time">3 days ago</span>
                                    </div>
                                </div>
                            </div>
                            <div class="notification-footer">
                                <a href="#" class="view-all-link">View all notifications</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Profile -->
                    <div class="profile-section">
                        <button class="profile-btn" id="profileBtn">
                            <div class="user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="user-info">
                                <span class="user-name" id="userName">John Doe</span>
                                <span class="user-role">Premium Member</span>
                            </div>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        
                        <div class="profile-menu" id="profileMenu">
                            <div class="profile-menu-header">
                                <div class="user-avatar-large">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="user-details">
                                    <h4 id="userNameLarge">John Doe</h4>
                                    <p>john.doe@email.com</p>
                                    <span class="member-badge">Premium Member</span>
                                </div>
                            </div>
                            
                            <div class="menu-divider"></div>
                            
                            <div class="menu-section">
                                <div class="menu-section-title">Account</div>
                                <a href="#" class="menu-item">
                                    <i class="fas fa-user"></i>
                                    <span>View Profile</span>
                                </a>
                                <a href="#" class="menu-item">
                                    <i class="fas fa-edit"></i>
                                    <span>Edit Profile</span>
                                </a>
                                <a href="#" class="menu-item">
                                    <i class="fas fa-shield-alt"></i>
                                    <span>Security & Privacy</span>
                                </a>
                            </div>
                            
                            <div class="menu-divider"></div>
                            
                            <div class="menu-section">
                                <div class="menu-section-title">Support</div>
                                <a href="#" class="menu-item">
                                    <i class="fas fa-question-circle"></i>
                                    <span>Help Center</span>
                                </a>
                                <a href="#" class="menu-item">
                                    <i class="fas fa-headset"></i>
                                    <span>Contact Support</span>
                                </a>
                            </div>
                            
                            <div class="menu-divider"></div>
                            
                            <a href="login.html" class="menu-item logout">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Sign Out</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Dashboard Content -->
    <main class="dashboard-main">
        <div class="container">
            <!-- Welcome Section -->
            <div class="welcome-section">
                <div class="welcome-content">
                    <h1 class="welcome-title">Welcome back, <span id="welcomeUserName">John</span>! ðŸ‘‹</h1>
                    <p class="welcome-subtitle">Here's what's happening with your loans today</p>
                </div>
                <div class="welcome-actions">
                    <button class="btn btn-primary">
                        <i class="fas fa-plus"></i>
                        Apply for New Loan
                    </button>
                    <button class="btn btn-secondary">
                        <i class="fas fa-calculator"></i>
                        Loan Calculator
                    </button>
                </div>
            </div>

            <!-- Dashboard Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value">$45,250</div>
                        <div class="stat-label">Total Loan Amount</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>2.5% from last month</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value">$1,247</div>
                        <div class="stat-label">Monthly Payment</div>
                        <div class="stat-change">
                            <i class="fas fa-calendar"></i>
                            <span>Due in 5 days</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value">750</div>
                        <div class="stat-label">Credit Score</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span>+15 points</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value">4.2%</div>
                        <div class="stat-label">Average APR</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-down"></i>
                            <span>0.3% lower</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Dashboard Grid -->
            <div class="dashboard-grid">
                <!-- Active Loans -->
                <div class="dashboard-section">
                    <div class="section-header">
                        <h2 class="section-title">Active Loans</h2>
                        <a href="#" class="view-all-link">View All</a>
                    </div>
                    
                    <div class="loans-list">
                        <div class="loan-card">
                            <div class="loan-header">
                                <div class="loan-info">
                                    <h4 class="loan-title">Personal Loan</h4>
                                    <p class="loan-id">#PL-2024-001</p>
                                </div>
                                <div class="loan-status approved">
                                    <span>Active</span>
                                </div>
                            </div>
                            <div class="loan-details">
                                <div class="detail-row">
                                    <span class="detail-label">Loan Amount</span>
                                    <span class="detail-value">$25,000</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Monthly Payment</span>
                                    <span class="detail-value">$547</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Next Payment</span>
                                    <span class="detail-value">Feb 15, 2025</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Balance</span>
                                    <span class="detail-value">$22,350</span>
                                </div>
                            </div>
                            <div class="loan-progress">
                                <div class="progress-info">
                                    <span>Progress</span>
                                    <span>10.6% paid</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 10.6%"></div>
                                </div>
                            </div>
                            <div class="loan-actions">
                                <button class="btn btn-secondary btn-sm">Make Payment</button>
                                <button class="btn btn-outline btn-sm">View Details</button>
                            </div>
                        </div>

                        <div class="loan-card">
                            <div class="loan-header">
                                <div class="loan-info">
                                    <h4 class="loan-title">Auto Loan</h4>
                                    <p class="loan-id">#AL-2024-001</p>
                                </div>
                                <div class="loan-status approved">
                                    <span>Active</span>
                                </div>
                            </div>
                            <div class="loan-details">
                                <div class="detail-row">
                                    <span class="detail-label">Loan Amount</span>
                                    <span class="detail-value">$20,250</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Monthly Payment</span>
                                    <span class="detail-value">$425</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Next Payment</span>
                                    <span class="detail-value">Feb 20, 2025</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Balance</span>
                                    <span class="detail-value">$18,900</span>
                                </div>
                            </div>
                            <div class="loan-progress">
                                <div class="progress-info">
                                    <span>Progress</span>
                                    <span>6.7% paid</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 6.7%"></div>
                                </div>
                            </div>
                            <div class="loan-actions">
                                <button class="btn btn-secondary btn-sm">Make Payment</button>
                                <button class="btn btn-outline btn-sm">View Details</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="dashboard-section">
                    <div class="section-header">
                        <h2 class="section-title">Recent Activity</h2>
                        <a href="#" class="view-all-link">View All</a>
                    </div>
                    
                    <div class="activity-list">
                        <div class="activity-item">
                            <div class="activity-icon success">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="activity-content">
                                <h4>Payment Processed</h4>
                                <p>Personal Loan payment of $547 was successfully processed</p>
                                <span class="activity-time">2 hours ago</span>
                            </div>
                        </div>

                        <div class="activity-item">
                            <div class="activity-icon info">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <div class="activity-content">
                                <h4>Document Uploaded</h4>
                                <p>Income verification document uploaded for loan #PL-2024-002</p>
                                <span class="activity-time">1 day ago</span>
                            </div>
                        </div>

                        <div class="activity-item">
                            <div class="activity-icon warning">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="activity-content">
                                <h4>Payment Reminder</h4>
                                <p>Auto Loan payment due in 3 days</p>
                                <span class="activity-time">2 days ago</span>
                            </div>
                        </div>

                        <div class="activity-item">
                            <div class="activity-icon success">
                                <i class="fas fa-thumbs-up"></i>
                            </div>
                            <div class="activity-content">
                                <h4>Loan Approved</h4>
                                <p>Your personal loan application has been approved</p>
                                <span class="activity-time">1 week ago</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="dashboard-section">
                    <div class="section-header">
                        <h2 class="section-title">Quick Actions</h2>
                    </div>
                    
                    <div class="quick-actions-grid">
                        <div class="quick-action-card">
                            <div class="action-icon">
                                <i class="fas fa-plus"></i>
                            </div>
                            <h4>Apply for Loan</h4>
                            <p>Start a new loan application</p>
                            <button class="btn btn-primary btn-sm w-full">Apply Now</button>
                        </div>

                        <div class="quick-action-card">
                            <div class="action-icon">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <h4>Loan Calculator</h4>
                            <p>Calculate monthly payments</p>
                            <button class="btn btn-secondary btn-sm w-full">Calculate</button>
                        </div>

                        <div class="quick-action-card">
                            <div class="action-icon">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <h4>Make Payment</h4>
                            <p>Pay your loan installment</p>
                            <button class="btn btn-secondary btn-sm w-full">Pay Now</button>
                        </div>

                        <div class="quick-action-card">
                            <div class="action-icon">
                                <i class="fas fa-headset"></i>
                            </div>
                            <h4>Contact Support</h4>
                            <p>Get help from our team</p>
                            <button class="btn btn-secondary btn-sm w-full">Contact</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- JavaScript -->
    <!-- Core components -->
    <script src="../js/home.js"></script>
    
    <!-- Loan Status Tracker Component -->
    <script src="../js/loan-status-tracker.js"></script>
    <script src="../js/loan-status-tracker-methods.js"></script>
    <script src="../js/loan-status-tracker-interactions.js"></script>
    
    <!-- Repayment Calendar Component -->
    <script src="../js/repayment-calendar.js"></script>
    <script src="../js/repayment-calendar-styles.js"></script>
    <script src="../js/repayment-calendar-methods.js"></script>
    <script src="../js/repayment-calendar-interactions.js"></script>
    
    <script>
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Load user data
            loadUserData();
            
            // Initialize notifications
            initNotifications();
            
            // Initialize profile menu
            initProfileMenu();
            
            // Initialize Loan Components
            initializeComponents();
        });

        function loadUserData() {
            // This would typically load from an API
            const userData = {
                name: 'John Doe',
                email: 'john.doe@email.com',
                membershipType: 'Premium Member'
            };

            document.getElementById('userName').textContent = userData.name;
            document.getElementById('userNameLarge').textContent = userData.name;
            document.getElementById('welcomeUserName').textContent = userData.name.split(' ')[0];
        }

        function initNotifications() {
            const notificationBtn = document.getElementById('notificationBtn');
            const notificationDropdown = document.getElementById('notificationDropdown');

            notificationBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                notificationDropdown.classList.toggle('active');
            });

            document.addEventListener('click', function() {
                notificationDropdown.classList.remove('active');
            });
        }

        function initProfileMenu() {
            const profileBtn = document.getElementById('profileBtn');
            const profileMenu = document.getElementById('profileMenu');

            profileBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                profileMenu.classList.toggle('active');
            });

            document.addEventListener('click', function() {
                profileMenu.classList.remove('active');
            });
        }

        function initializeComponents() {
            // Loan status tracker and repayment calendar are self-initializing
            console.log("Loan status tracker and repayment calendar initialized");
            
            // Set up action buttons for apply and calculate
            setupActionButtons();
        }

        function setupActionButtons() {
            // Apply for loan buttons
            const applyButtons = document.querySelectorAll('.btn-primary:not(.make-payment-btn):not(.process-payment-btn)');
            applyButtons.forEach(button => {
                button.addEventListener('click', openNewApplication);
            });
            
            // Calculator buttons
            const calcButtons = document.querySelectorAll('.btn-secondary:contains("Calculate")');
            calcButtons.forEach(button => {
                button.addEventListener('click', openCalculator);
            });
            
            // Make payment buttons
            const paymentButtons = document.querySelectorAll('.btn-secondary:contains("Make Payment")');
            paymentButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Find the loan ID from the closest loan card
                    const loanCard = button.closest('.loan-card');
                    if (loanCard) {
                        const loanIdElement = loanCard.querySelector('.loan-id');
                        const loanId = loanIdElement ? loanIdElement.textContent.trim().substring(1) : null;
                        
                        if (loanId && window.RepaymentCalendar) {
                            // Show make payment modal using RepaymentCalendar component
                            window.RepaymentCalendar.showRepaymentSchedule({id: loanId});
                        }
                    }
                });
            });
        }

        function openCalculator() {
            // Open loan calculator modal or navigate to calculator page
            window.open('../index.html#calculator', '_blank');
        }

        function openNewApplication() {
            // Navigate to loan application
            window.location.href = '../html/loan-application.html';
        }
    </script>
</body>
</html>
