<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reset Password - QuickCred | Secure Password Recovery</title>
  <meta name="description" content="Reset your QuickCred password securely. Enter your email to receive password reset instructions.">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="../css/modern-style.css">
  <link rel="stylesheet" href="../css/auth.css">
  <link rel="icon" href="../assets/QuickCred_logo1.png" type="image/png">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="auth-body">
  <!-- Background Elements -->
  <div class="auth-background">
    <div class="gradient-orb orb-1"></div>
    <div class="gradient-orb orb-2"></div>
    <div class="gradient-orb orb-3"></div>
  </div>

  <!-- Main Container -->
  <div class="auth-container">
    <!-- Left Panel - Branding -->
    <div class="auth-branding">
      <div class="branding-content">
        <div class="brand-header">
          <img src="../assets/QuickCred_logo1.png" alt="QuickCred" class="brand-logo">
          <h1 class="brand-title">QuickCred</h1>
        </div>
        
        <div class="branding-message">
          <h2>Password Recovery</h2>
          <p>Don't worry! It happens to the best of us. Enter your email address and we'll send you a link to reset your password.</p>
        </div>
        
        <div class="feature-highlights">
          <div class="feature-item">
            <i class="fas fa-shield-alt"></i>
            <span>Secure password reset</span>
          </div>
          <div class="feature-item">
            <i class="fas fa-envelope"></i>
            <span>Email verification required</span>
          </div>
          <div class="feature-item">
            <i class="fas fa-clock"></i>
            <span>Reset link expires in 1 hour</span>
          </div>
        </div>
        
        <div class="testimonial">
          <div class="testimonial-content">
            <p>"The password reset process was quick and secure. I was back in my account within minutes!"</p>
            <div class="testimonial-author">
              <span class="author-name">Jessica Martinez</span>
              <div class="author-rating">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Panel - Reset Form -->
    <div class="auth-form-panel">
      <div class="form-container">
        <!-- Header -->
        <div class="form-header">
          <div class="back-link">
            <a href="login-new.html" class="back-btn">
              <i class="fas fa-arrow-left"></i>
              <span>Back to Sign In</span>
            </a>
          </div>
          
          <div class="form-title">
            <h2>Reset Password</h2>
            <p>Enter your email address and we'll send you reset instructions</p>
          </div>
        </div>

        <!-- Reset Form -->
        <div id="resetForm">
          <form class="auth-form" id="passwordResetForm">
            <div class="form-group">
              <label for="email" class="form-label">
                <i class="fas fa-envelope"></i>
                Email Address
              </label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                class="form-input" 
                placeholder="Enter your registered email" 
                required
                autocomplete="email"
              >
              <div class="input-feedback" id="emailFeedback"></div>
            </div>

            <button type="submit" class="btn btn-primary btn-large w-full" id="resetBtn">
              <span class="btn-text">Send Reset Instructions</span>
              <div class="btn-loader" id="resetLoader">
                <i class="fas fa-spinner fa-spin"></i>
              </div>
            </button>
          </form>

          <div class="form-footer">
            <p class="signup-prompt">
              Remember your password? 
              <a href="login-new.html" class="signup-link">Sign in</a>
            </p>
            <p class="signup-prompt">
              Don't have an account? 
              <a href="signup-new.html" class="signup-link">Create account</a>
            </p>
          </div>
        </div>

        <!-- Success Message -->
        <div id="successMessage" style="display: none;">
          <div class="success-content">
            <div class="success-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <h3>Check Your Email</h3>
            <p>We've sent password reset instructions to <strong id="sentEmail"></strong></p>
            <p class="help-text">
              Didn't receive the email? Check your spam folder or 
              <button type="button" class="resend-btn" id="resendBtn">resend instructions</button>
            </p>
            
            <div class="success-actions">
              <a href="login-new.html" class="btn btn-outline">Back to Sign In</a>
              <button type="button" class="btn btn-primary" onclick="location.reload()">Try Another Email</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p>Sending reset instructions...</p>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    // Initialize forgot password page
    document.addEventListener('DOMContentLoaded', function() {
      initPasswordResetForm();
      initResendFunctionality();
    });

    function initPasswordResetForm() {
      const form = document.getElementById('passwordResetForm');
      const emailInput = document.getElementById('email');
      const resetBtn = document.getElementById('resetBtn');
      const btnText = resetBtn.querySelector('.btn-text');
      const btnLoader = resetBtn.querySelector('.btn-loader');

      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const email = emailInput.value.trim();

        // Basic validation
        if (!email) {
          showError('Please enter your email address');
          return;
        }

        if (!isValidEmail(email)) {
          showError('Please enter a valid email address');
          return;
        }

        // Show loading state
        resetBtn.disabled = true;
        btnText.style.opacity = '0';
        btnLoader.style.display = 'flex';

        try {
          // Simulate password reset process (replace with actual API call)
          await new Promise(resolve => setTimeout(resolve, 2000));
          
          // Success - show success message
          showSuccessScreen(email);
          
        } catch (error) {
          showError('Failed to send reset instructions. Please try again.');
          
          // Reset button state
          resetBtn.disabled = false;
          btnText.style.opacity = '1';
          btnLoader.style.display = 'none';
        }
      });

      // Real-time email validation
      emailInput.addEventListener('blur', function() {
        const email = this.value.trim();
        const feedback = document.getElementById('emailFeedback');
        
        if (email && !isValidEmail(email)) {
          feedback.textContent = 'Please enter a valid email address';
          feedback.className = 'input-feedback error';
          this.classList.add('error');
        } else {
          feedback.textContent = '';
          feedback.className = 'input-feedback';
          this.classList.remove('error');
        }
      });
    }

    function initResendFunctionality() {
      const resendBtn = document.getElementById('resendBtn');
      let resendTimeout;
      let resendCount = 0;

      resendBtn.addEventListener('click', async function() {
        if (resendCount >= 3) {
          showError('Maximum resend attempts reached. Please try again later.');
          return;
        }

        const email = document.getElementById('sentEmail').textContent;
        
        // Disable button temporarily
        resendBtn.disabled = true;
        resendBtn.textContent = 'Sending...';

        try {
          // Simulate resend process
          await new Promise(resolve => setTimeout(resolve, 1500));
          
          resendCount++;
          showSuccess('Reset instructions sent again!');
          
          // Re-enable button after cooldown
          let countdown = 30;
          resendBtn.textContent = `Resend in ${countdown}s`;
          
          resendTimeout = setInterval(() => {
            countdown--;
            if (countdown > 0) {
              resendBtn.textContent = `Resend in ${countdown}s`;
            } else {
              clearInterval(resendTimeout);
              resendBtn.disabled = false;
              resendBtn.textContent = 'resend instructions';
            }
          }, 1000);
          
        } catch (error) {
          showError('Failed to resend instructions. Please try again.');
          resendBtn.disabled = false;
          resendBtn.textContent = 'resend instructions';
        }
      });
    }

    function showSuccessScreen(email) {
      document.getElementById('resetForm').style.display = 'none';
      document.getElementById('successMessage').style.display = 'block';
      document.getElementById('sentEmail').textContent = email;
      
      // Update form title
      const formTitle = document.querySelector('.form-title h2');
      const formSubtitle = document.querySelector('.form-title p');
      formTitle.textContent = 'Email Sent!';
      formSubtitle.textContent = 'Check your inbox for reset instructions';
    }

    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }

    function showError(message) {
      showNotification(message, 'error');
    }

    function showSuccess(message) {
      showNotification(message, 'success');
    }

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `notification notification-${type}`;
      notification.textContent = message;
      
      const colors = {
        success: 'var(--success-500)',
        error: 'var(--error-500)',
        info: 'var(--primary-500)'
      };
      
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 16px 24px;
        background: ${colors[type]};
        color: white;
        border-radius: var(--rounded-lg);
        box-shadow: var(--shadow-lg);
        z-index: 1000;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        max-width: 300px;
      `;
      
      document.body.appendChild(notification);
      
      // Animate in
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);
      
      // Remove after 5 seconds
      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          notification.remove();
        }, 300);
      }, 5000);
    }
  </script>

  <style>
    /* Additional styles for forgot password page */
    .success-content {
      text-align: center;
      padding: var(--space-6) 0;
    }

    .success-icon {
      width: 80px;
      height: 80px;
      background: var(--success-100);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-6);
      color: var(--success-600);
      font-size: 2rem;
    }

    .success-content h3 {
      font-size: var(--text-2xl);
      font-weight: 700;
      margin: 0 0 var(--space-4) 0;
      color: var(--gray-900);
    }

    .success-content p {
      color: var(--gray-600);
      margin: 0 0 var(--space-4) 0;
      line-height: 1.6;
    }

    .help-text {
      font-size: var(--text-sm);
      color: var(--gray-500);
    }

    .resend-btn {
      background: none;
      border: none;
      color: var(--primary-600);
      cursor: pointer;
      text-decoration: underline;
      font-size: var(--text-sm);
      padding: 0;
    }

    .resend-btn:hover {
      color: var(--primary-700);
    }

    .resend-btn:disabled {
      color: var(--gray-400);
      cursor: not-allowed;
      text-decoration: none;
    }

    .success-actions {
      display: flex;
      gap: var(--space-3);
      margin-top: var(--space-6);
      justify-content: center;
    }

    @media (max-width: 640px) {
      .success-actions {
        flex-direction: column;
      }
      
      .success-actions .btn {
        width: 100%;
      }
    }
  </style>
  
  <!-- External Auth Script -->
  <script src="../js/auth.js"></script>
</body>
</html>
